---

# title: yaml语法

---

### 一、yaml语法简介：

YAML（/ˈjæməl/，尾音类似 camel 骆驼）是一个可读性高，用来表达数据序列化的格式。YAML 参考了其他多种语言，包括： C 语言、 Python、Perl，并从 XML、电子邮件的数据格式（RFC 2822）中获得灵感。Clark Evans 在 2001 年首次发表了这种语言 ，另外 Ingy döt Net 与 Oren Ben-Kiki 也是这语言的共同设计者 。当前已经有数种编程语言或脚本语言支持（或者说解析）这种语言。

著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。YAML (YAML Aint Markup Language)是一种标记语言，通常以.yml或者.yaml为后缀的文件，是一种直观的能够被电脑识别的数据序列化格式，并且容易被人类阅读，容易和脚本语言交互的，可以被支持YAML库的不同的编程语言程序导入，一种专门用来写配置文件的语言。可用于如： Java，C/C++, Ruby, Python, Perl, C#, PHP等。



### 二、YML的优点

1. YAML易于人们阅读。
2. YAML数据在编程语言之间是可移植的。
3. YAML匹配敏捷语言的本机数据结构。
4. YAML具有一致的模型来支持通用工具。
5. YAML支持单程处理。
6. YAML具有表现力和可扩展性。
7. YAML易于实现和使用。



### 三、YML语法

#### 1.**语法**

- k: v 表示键值对关系，**冒号后面必须有一个空格**
- 使用空格的缩进表示层级关系，空格数目不重要，只要是左对齐的一列数据，都是同一个层级的
- 大小写敏感
- ***缩进时不允许使用Tab键，只允许使用空格。***

- YAML 使用可打印的 Unicode 字符，可使用 UTF-8 或 UTF-16。
-  注解由井字号（ # ）开始，可以出现在一行中的任何位置，而且范围只有一行（也就是一般所谓的单行注解）
- 每个清单成员以单行表示，并用短杠 + 空白（ -   ）起始。或使用方括号（ [ ] ），并用逗号 + 空白（ ,   ）分开成员。
- 每个散列表的成员用冒号 + 空白（ :   ）分开键值和内容。或使用大括号（ {   } ），并用逗号 + 空白（ ,   ）分开。
-  散列表的键值可以用问号 ( ? ) 起始，用来明确的表示多个词汇组成的键值。
- 字符串平常并不使用引号，但必要的时候可以用双引号 ( " ) 或单引号 ( ' ) 框住。
-  使用双引号表示字符串时，可用倒斜线（ \ ）开始的转义字符（这跟 C 语言类似）表示特殊字符。
-  区块的字符串用缩进和修饰符（非必要）来和其他数据分隔，有新行保留（preserve）（使用符号 | ）或新行折叠（flod）（使用符号 > ）两种方式。
-  在单一文件中，可用连续三个连字号（---）区分多个文件。
-  另外，还有选择性的连续三个点号（ ... ）用来表示文件结尾。
-  重复的内容可使从参考标记星号 ( * ) 复制到锚点标记（ & ）。
-  指定格式可以使用两个惊叹号 ( !! )，后面接上名称。
-  文件中的单一文件可以使用指导指令，使用方法是百分比符号 ( % )。有两个指导指令在 YAML1.1 版中被定义：
-  % YAML 指导指令，用来识别文件的 YAML 版本。
-  % TAG 指导指令，被用在 URI 的前缀标记。这个方法在标记节点的类型时相当有用。
-  YAML 在使用逗号及冒号时，后面都必须接一个空白字符，所以可以在字符串或数值中自由加入分隔符号（例如：5,280 或 [http://www.wikipedia.org](https://links.jianshu.com/go?to=http%3A%2F%2Fwww.wikipedia.org)）而不  需要使用引号。

#### 2、基本类型：

yaml中有以下基本类型：

```
字符串
整型
浮点型
布尔型
null
时间
日期
```

#### 3. **键值关系**

(以Java语言为例，其它语言类似)对于键与值主要是看能否表示以下内容。普通的值(数字、字符串、布尔)、日期、对象、数组、集合等。



##### 1) 普通值(字面量)

- k: v：字面量直接写；

- 字符串默认不用加上单引号或者双引号；

- “”: 双引号；不会转义字符串里面的特殊字符；特殊字符会作为本身想表示的意思

- name: “zhangsan \n lisi”：输出；zhangsan 换行 lisi

- ‘’：单引号；会转义特殊字符，特殊字符最终只是一个普通的字符串数据

~~~
name1: zhangsan
name2: 'zhangsan \n lisi'
name3: "zhangsan \n lisi"
age: 18
flag: true
~~~



##### 2)日期

~~~
date: 2019/01/01
~~~



##### 3）清单（数组）

~~~
 --- # 最喜爱的电影
 - Casablanca
 - North by Northwest
 - Notorious
~~~

行内写法：另外还有一种内置格式（inline format）可以选择用方括号围住，并用逗号 + 空白区隔（类似 JSON 的语法）

~~~
 --- # 购物清单
 [milk, pumpkin pie, eggs, juice]
~~~



##### 4）散列表

键值和数据由冒号及空白字符分开。区块形式（常使用与 YAML 数据文档中）使用缩进和换行符分隔 key: value 对。

~~~
--- # 区块形式
   name: John Smith
   age: 33
~~~

内置形式（常使用与 YAML 数据流中）在大括号中使用逗号 + 空白字符分隔 key: value 对。

~~~
--- # 內置形式
 {name: John Smith, age: 33}
~~~



##### 5)对象(属性和值)、Map(键值对)

在下一行来写对象的属性和值的关系，注意缩进

~~~
people:
    name: zhangsan
    age: 20
~~~

行内写法：另外还有一种内置格式（inline format）可使用大括号（ {   } ），并用逗号 + 空白（ ,   ）分开（类似 JSON 的语法）

```
people: {name: zhangsan,age: 20}
```



##### 6)数组、list、set

用- 值表示数组中的一个元素

```
pets:
    - dog
    - pig
    - cat

```


行内写法：

~~~
pets: [dog,pig,cat]
~~~



##### 7)数组对象、list对象、set对象

```
peoples:
    - name: zhangsan
      age: 22
    - name: lisi
      age: 20
    - {name: wangwu,age: 18}
```



##### 8）区块的字符

再次强调，字符串不需要包在引号之内。有两种方法书写多行文字（multi-line strings），一种可以保存新行（使用 | 字符），另一种可以折叠新行（使用 > 字符）。

###### 保存新行 (Newlines preserved)

~~~
data: |                                     # 译者注：这是一首著名的五行民谣(limerick)
   There once was a man from Darjeeling     # 这里曾有一个人來自大吉岭
   Who got on a bus bound for Ealing        # 他搭上一班往伊灵的公车
       It said on the door                  # 门上这么说的
       "Please don't spit on the floor"     # "请勿在地上吐痰"
   So he carefully spat on the ceiling      # 所以他小心翼翼的吐在天花板上
~~~

根据设置，前方的引领空白符号（leading white space）必须排成条状，以便和其他数据或是行为（如示例中的缩进）明显区分。

###### 折叠新行 (Newlines folded)

```csharp
data: >
   Wrapped text         # 摺疊的文字
   will be folded       # 將會被收
   into a single        # 進單一一個
   paragraph            # 段落
   
   Blank lines denote   # 空白的行代表
   paragraph breaks     # 段落之間的區隔
```

和保存新行不同的是，换行字符会被转换成空白字符。而引领空白字符则会被自动消去。

##### 9）层次结构化的元素

清单中使用散列表

```css
- {name: John Smith, age: 33}
- name: Mary Smith
  age: 27
```

###### 散列表中使用清单

```css
men: [John Smith, Bill Jones]
women:
  - Mary Smith
  - Susan Williams
```

### 四、YAML 的高级组件

这部分算是一个后续的讨论，在比较各种数数据列语言时，YAML 最常被提到的特色有两个：关系树和数据形态。

#### 树状结构之间的交互引用

##### 数据合并和参考

为了维持文件的简洁，并避免数据输入的错误，YAML 提供了结点参考（*）和散列合并（<<）参考到其他结点标签的锚点标记（&）。参考会将树状结构加入锚点标记的内容，并可以在所有数据结构中运作（可以参考上面 "ship-to" 的示例）合并只有散列表可以使用，可以将键值自锚点标记复制到指定的散列表中。

当数据被 instantiate 合并和参考会被剖析器自动展开。



```
#眼部雷射手術之標準程序
---
- step:  &id001                  # 定義錨點標籤 &id001
    instrument:      Lasik 2000
    pulseEnergy:     5.4
    pulseDuration:   12
    repetition:      1000
    spotSize:        1mm

- step:
     <<: *id001                  # 合併鍵值：使用在錨點標籤定義的內容
     spotSize:       2mm         # 覆寫"spotSize"鍵值

- step:
     <<: *id001                  # 合併鍵值：使用在錨點標籤定義的內容
     pulseEnergy:    500.0       # 覆寫鍵值
     alert: >                    # 加入其他鍵值
           warn patient of 
           audible pop
```

##### 数据形态

由于自动判定数据形态的功能，严格类型（也就是用户有宣告的数据形态）很难在大部分的 YAML 文件中看到。数据类型可以被区分成三大类：原码（core），定义（defined），用户定义（user-defined）。原码可以自动被解析器分析（例如：浮点数，整数，字符串，清单，映射，...）。有一些高级的数据形态──例如比特数据──在 YAML 中有被 “定义”，但不是每一种解析器都有支持。最后，YAML 支持用户自定的区域变量，包括：自定义的类别，结构或基本类型（例如：四倍精度的浮点数）。

##### 强制转型

YAML 的自动判定数据形态是哪一种实体。但有时用户会想要将数据强制转型成自定的某种类型。最常见的状况是字符串，有时候可能看起来像数字或布尔值，这种时候可以使用双引号，或是使用严格类型标签。



```objectivec
---
a: 123                     # 整數
b: "123"                   # 字串（使用雙括號）
c: 123.0                   # 浮點數
d: !!float 123             # 浮點數，使用!!表達的嚴格型態
e: !!str 123               # 字串，使用嚴格型態
f: !!str Yes               # 字串，使用嚴格型態
g: Yes                     # 布林值"真"
h: Yes we have No bananas  # 字串（包含"Yes"和"No"）
```

##### 其他特殊数据形态

除了一般的数据形态之外，用户也可以使用一些较为高级的类型，但不保证可被每种解析器分析。使用时和强制转型类似，要在形态名称之前加上两个惊叹号（!!）。有几种重要的形态在本篇没有讨论，包括集合（sets），有序映照（ordered maps），时间戳记（timestamps）以及十六进制数据（hexadecimal）。
